<% data = Day.group(:moodrating).count %>
<% mood_colors = {5 => '#d9ffcc', 4 => '#b4ff99', 3 => '#8eff66', 2 => '#7bff4c', 1 => '#43ff00', 0 => '#36cc00', -1 => '#289900', -2 => '#1b6600', -3 => '#0d3300', -4 => '#112f06', -5 => '##000000'} %>
<% colors = [] %>
<% data.each do |moodrating, _|%>
 <%  colors << mood_colors[moodrating] %>
<% end %>

<p style="color: green"><%= notice %></p>

<pre id="t1">
    __  ___                ________                __            
   /  |/  /___  ____  ____/ /_  __/________ ______/ /_____  _____
  / /|_/ / __ \/ __ \/ __  / / / / ___/ __ `/ ___/ //_/ _ \/ ___/
 / /  / / /_/ / /_/ / /_/ / / / / /  / /_/ / /__/ ,< /  __/ /    
/_/  /_/\____/\____/\__,_/ /_/ /_/   \__,_/\___/_/|_|\___/_/     
                                                                 
</pre>


<button type='button' class= "backbutton" onclick="location.href='<%= new_day_path() %>';">Create new daily entry</button> 

<div id="piechartbutton" class="leftshift1"><button onclick="switchpiechart()">See pie chart</button></div>

<div id="linechartbutton" class="hidden leftshift1"><button onclick="switchlinechart()">See line chart</button></div>


<div id="linechart">
<%= line_chart Day.group_by_day(:mooddate).sum(:moodrating) %>
</div>

<div id="piechart" class="hidden">
<%= pie_chart data, colors: colors %>
</div>

<div style="display: flex;">
  <div class="leftshift1"><button onclick="switchall()">All</button></div>
  <div class="leftshift1"><button onclick="switchmoodrating()">Ratings</button></div>
  <div class="leftshift1"><button onclick="switchmoodword()">Mood-Words</button></div>
  <div class="leftshift1"><button onclick="switchmoodjournal()">Descriptions</button></div>
</div>

<div class="leftshift1" id="searchall"><%= render 'search/formall'%></div>

<div  class="hidden" id="searchmoodrating"><%= render 'search/formmoodrating'%></div>

<div  class="hidden" id="searchmoodword"><%= render 'search/formmoodword'%></div>

<div  class="hidden" id="searchmoodjournal"><%= render 'search/formmoodjournal'%></div>

<footer class="leftshift1" id="footer"></footer>





<script>

  function switchpiechart() {
    var linechart = document.getElementById("linechart");
    var piechart = document.getElementById("piechart");
    var linechartbutton = document.getElementById("linechartbutton");
    var piechartbutton = document.getElementById("piechartbutton");

    piechart.classList.remove("hidden");
    linechart.classList.add("hidden");
    piechartbutton.classList.add("hidden");
    linechartbutton.classList.remove("hidden");
  }

  function switchlinechart() {
    var linechart = document.getElementById("linechart");
    var piechart = document.getElementById("piechart");
    var linechartbutton = document.getElementById("linechartbutton");
    var piechartbutton = document.getElementById("piechartbutton");

    piechart.classList.add("hidden");
    linechart.classList.remove("hidden");
    piechartbutton.classList.remove("hidden");
    linechartbutton.classList.add("hidden");
  }

  function switchmoodrating() {
    var searchall = document.getElementById("searchall");
    var searchmoodrating = document.getElementById("searchmoodrating");
    var searchmoodword = document.getElementById("searchmoodword");
    var searchmoodjournal = document.getElementById("searchmoodjournal");
    
    searchmoodjournal.classList.add("hidden");
    searchmoodword.classList.add("hidden");
    searchall.classList.add("hidden");
    searchmoodrating.classList.remove("hidden");

  }

  function switchall() {
    var searchall = document.getElementById("searchall");
    var searchmoodrating = document.getElementById("searchmoodrating");
    var searchmoodword = document.getElementById("searchmoodword");
    var searchmoodjournal = document.getElementById("searchmoodjournal");
    
    searchmoodjournal.classList.add("hidden");
    searchmoodword.classList.add("hidden");
    searchmoodrating.classList.add("hidden");
    searchall.classList.remove("hidden");

  }

  function switchmoodword() {
    var searchall = document.getElementById("searchall");
    var searchmoodrating = document.getElementById("searchmoodrating");
    var searchmoodword = document.getElementById("searchmoodword");
    var searchmoodjournal = document.getElementById("searchmoodjournal");

    searchmoodrating.classList.add("hidden");
    searchall.classList.add("hidden");
    searchmoodjournal.classList.add("hidden");
    searchmoodword.classList.remove("hidden");

  }

  function switchmoodjournal() {
    var searchall = document.getElementById("searchall");
    var searchmoodrating = document.getElementById("searchmoodrating");
    var searchmoodword = document.getElementById("searchmoodword");
    var searchmoodjournal = document.getElementById("searchmoodjournal");

    searchmoodrating.classList.add("hidden");
    searchall.classList.add("hidden");
    searchmoodword.classList.add("hidden");
    searchmoodjournal.classList.remove("hidden");

  }
  const today = new Date();

  let thisYear = today.getFullYear();

  console.log(thisYear);

  const footer = document.querySelector("#footer");

  const copyright = document.createElement("p");


  copyright.setAttribute('id','copyright');

  copyright.innerText = "Natalie Petrolino (aka vsspnkr) and Greg Curl with Code the Dream " + thisYear + " ฅ^._.^ฅ";

  footer.appendChild(copyright);


  window.addEventListener("load", function() {
    
    let catblink = document.getElementById('copyright');
    
    setInterval(function() {
        
        catblink.innerText = (catblink.innerText == 'Natalie Petrolino (aka vsspnkr) and Greg Curl with Code the Dream ' + thisYear + ' ฅ^._.^ฅ' ? 'Natalie Petrolino (aka vsspnkr) and Greg Curl with Code the Dream ' + thisYear + ' ฅ^u_u^ฅ' : 'Natalie Petrolino (aka vsspnkr) and Greg Curl with Code the Dream ' + thisYear + ' ฅ^._.^ฅ');

    }, 1000);

} , false);
</script>
